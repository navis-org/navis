<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Python library for analysis of neuroanatomical data."><link href="../../4_remote/tutorial_remote_04_h01/" rel="prev"><link href="../tutorial_nblast_03_smat/" rel="next"><link rel="icon" href="../../../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>NBLAST - navis</title><link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="stylesheet" href="../../../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../../../assets/_markdown_exec_pyodide.css"><link rel="stylesheet" href="../../../../assets/_mkdocstrings.css"><link rel="stylesheet" href="../../../../stylesheets/extra.css"><link rel="stylesheet" href="../../../../assets/external/unpkg.com/katex@0/dist/katex.min.css"><link rel="stylesheet" href="../../../../sg_gallery.css"><link rel="stylesheet" href="../../../../sg_gallery-rendered-html.css"><link rel="stylesheet" href="../../../../sg_gallery-binder.css"><link rel="stylesheet" href="../../../../sg_gallery-dataframe.css"><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#nblast" class="md-skip"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="Header"> <a href="../../../.." title="navis" class="md-header__button md-logo" aria-label="navis" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> navis </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> NBLAST </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M296.5 291.1C321 265.2 336 230.4 336 192c0-79.5-64.5-144-144-144S48 112.5 48 192c0 38.4 15 73.2 39.5 99.1 21.3 22.4 44.9 54 53.3 92.9h102.4c8.4-39 32-70.5 53.3-92.9m34.8 33C307.7 349 288 379.4 288 413.7V432c0 44.2-35.8 80-80 80h-32c-44.2 0-80-35.8-80-80v-18.3c0-34.3-19.7-64.7-43.3-89.6C20 289.7 0 243.2 0 192 0 86 86 0 192 0s192 86 192 192c0 51.2-20 97.7-52.7 132.1M144 184c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-48.6 39.4-88 88-88 13.3 0 24 10.7 24 24s-10.7 24-24 24c-22.1 0-40 17.9-40 40"></path></svg> </label> <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="pink" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M292.9 384c7.3-22.3 21.9-42.5 38.4-59.9C364 289.7 384 243.2 384 192 384 86 298 0 192 0S0 86 0 192c0 51.2 20 97.7 52.7 132.1 16.5 17.4 31.2 37.6 38.4 59.9h201.7zm-4.9 48H96v16c0 44.2 35.8 80 80 80h32c44.2 0 80-35.8 80-80zM184 112c-39.8 0-72 32.2-72 72 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-66.3 53.7-120 120-120 13.3 0 24 10.7 24 24s-10.7 24-24 24"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="Search"> <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/navis-org/navis" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> navis-org/navis </div> </a> </div> </nav> <nav class="md-tabs" aria-label="Tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../../../.." class="md-tabs__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> Home </a> </li> <li class="md-tabs__item"> <a href="../../../../installation/" class="md-tabs__link"> Installation </a> </li> <li class="md-tabs__item"> <a href="../../../../quickstart/" class="md-tabs__link"> Quickstart </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href="../../" class="md-tabs__link"> Tutorials </a> </li> <li class="md-tabs__item"> <a href="../../../../ecosystem/" class="md-tabs__link"> <span style="color:rgb(250,175,3)">NAVis</span> &amp; Friends </a> </li> <li class="md-tabs__item"> <a href="../../../../publications/" class="md-tabs__link"> Publications </a> </li> <li class="md-tabs__item"> <a href="../../../../changelog/" class="md-tabs__link"> Changelog </a> </li> <li class="md-tabs__item"> <a href="../../../../api/" class="md-tabs__link"> API Documentation </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../../../.." title="navis" class="md-nav__button md-logo" aria-label="navis" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> navis </label> <div class="md-nav__source"> <a href="https://github.com/navis-org/navis" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> navis-org/navis </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../.." class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item"> <a href="../../../../installation/" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.71 20.29-1.42 1.42a1 1 0 0 1-1.41 0L7 9.85A3.8 3.8 0 0 1 6 10a4 4 0 0 1-3.78-5.3l2.54 2.54.53-.53 1.42-1.42.53-.53L4.7 2.22A4 4 0 0 1 10 6a3.8 3.8 0 0 1-.15 1l11.86 11.88a1 1 0 0 1 0 1.41M2.29 18.88a1 1 0 0 0 0 1.41l1.42 1.42a1 1 0 0 0 1.41 0l5.47-5.46-2.83-2.83M20 2l-4 2v2l-2.17 2.17 2 2L18 8h2l2-4Z"></path></svg> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a href="../../../../quickstart/" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"></path></svg> <span class="md-ellipsis"> Quickstart </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked> <div class="md-nav__link md-nav__container"> <a href="../../" class="md-nav__link "> <span class="md-ellipsis"> Tutorials </span> </a> <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2"> <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0"> <span class="md-ellipsis"> General Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> General Tutorials </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../tutorial_basic_00_basics/" class="md-nav__link"> <span class="md-ellipsis"> The Basics </span> </a> </li> <li class="md-nav__item"> <a href="../../tutorial_basic_01_neurons/" class="md-nav__link"> <span class="md-ellipsis"> Neuron Types </span> </a> </li> <li class="md-nav__item"> <a href="../../tutorial_basic_02_neuronlists/" class="md-nav__link"> <span class="md-ellipsis"> Lists of Neurons </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3"> <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0"> <span class="md-ellipsis"> Import / Export </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Import / Export </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../0_io/tutorial_io_00_skeletons/" class="md-nav__link"> <span class="md-ellipsis"> Skeletons </span> </a> </li> <li class="md-nav__item"> <a href="../../0_io/tutorial_io_01_meshes/" class="md-nav__link"> <span class="md-ellipsis"> Meshes </span> </a> </li> <li class="md-nav__item"> <a href="../../0_io/tutorial_io_02_dotprops/" class="md-nav__link"> <span class="md-ellipsis"> Dotprops </span> </a> </li> <li class="md-nav__item"> <a href="../../0_io/tutorial_io_04_pickle/" class="md-nav__link"> <span class="md-ellipsis"> Pickling </span> </a> </li> <li class="md-nav__item"> <a href="../../0_io/zzz_tutorial_io_05_skeletonize/" class="md-nav__link"> <span class="md-ellipsis"> Skeletons from light-level data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4"> <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0"> <span class="md-ellipsis"> Plotting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_4"> <span class="md-nav__icon md-icon"></span> Plotting </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_00_intro/" class="md-nav__link"> <span class="md-ellipsis"> Plotting Overview </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_01_colors/" class="md-nav__link"> <span class="md-ellipsis"> Coloring </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_02_1d/" class="md-nav__link"> <span class="md-ellipsis"> Neuron "Barcodes" </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_03_dend/" class="md-nav__link"> <span class="md-ellipsis"> Neuron Topology </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_04_skeletons/" class="md-nav__link"> <span class="md-ellipsis"> Fine-tuning Skeletons </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_05_depth/" class="md-nav__link"> <span class="md-ellipsis"> Depth-coloring </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_06_cortex/" class="md-nav__link"> <span class="md-ellipsis"> Cortical Neurons </span> </a> </li> <li class="md-nav__item"> <a href="../../1_plotting/tutorial_plotting_07_xkcd/" class="md-nav__link"> <span class="md-ellipsis"> XKCD Style </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5"> <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0"> <span class="md-ellipsis"> Morphology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_5"> <span class="md-nav__icon md-icon"></span> Morphology </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../2_morpho/tutorial_morpho_00_manipulate/" class="md-nav__link"> <span class="md-ellipsis"> Manipulate Morphology </span> </a> </li> <li class="md-nav__item"> <a href="../../2_morpho/tutorial_morpho_01_analyze/" class="md-nav__link"> <span class="md-ellipsis"> Analyzing Neuron Morphology </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6"> <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0"> <span class="md-ellipsis"> Interfaces </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_6"> <span class="md-nav__icon md-icon"></span> Interfaces </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../3_interfaces/tutorial_interfaces_00_neuron/" class="md-nav__link"> <span class="md-ellipsis"> NEURON simulator </span> </a> </li> <li class="md-nav__item"> <a href="../../3_interfaces/tutorial_interfaces_01_neuron2/" class="md-nav__link"> <span class="md-ellipsis"> Visualize NEURON model </span> </a> </li> <li class="md-nav__item"> <a href="../../3_interfaces/tutorial_interfaces_02_blender/" class="md-nav__link"> <span class="md-ellipsis"> Blender 3D </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7"> <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0"> <span class="md-ellipsis"> Remote Data Sources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_7"> <span class="md-nav__icon md-icon"></span> Remote Data Sources </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../4_remote/tutorial_remote_00_neuprint/" class="md-nav__link"> <span class="md-ellipsis"> neuPrint </span> </a> </li> <li class="md-nav__item"> <a href="../../4_remote/tutorial_remote_01_cloudvolume/" class="md-nav__link"> <span class="md-ellipsis"> Neuroglancer &amp; CloudVolume </span> </a> </li> <li class="md-nav__item"> <a href="../../4_remote/tutorial_remote_02_microns/" class="md-nav__link"> <span class="md-ellipsis"> The MICrONS Datasets </span> </a> </li> <li class="md-nav__item"> <a href="../../4_remote/tutorial_remote_03_insect_db/" class="md-nav__link"> <span class="md-ellipsis"> Insect Brain DB </span> </a> </li> <li class="md-nav__item"> <a href="../../4_remote/tutorial_remote_04_h01/" class="md-nav__link"> <span class="md-ellipsis"> H01 Dataset </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" checked> <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0"> <span class="md-ellipsis"> NBLAST </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_4_8"> <span class="md-nav__icon md-icon"></span> NBLAST </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> NBLAST </span> <span class="md-nav__icon md-icon"></span> </label> <a href="./" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> NBLAST </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#what-is-nblast" class="md-nav__link"> <span class="md-ellipsis"> What is NBLAST? </span> </a> </li> <li class="md-nav__item"> <a href="#running-nblast" class="md-nav__link"> <span class="md-ellipsis"> Running NBLAST </span> </a> </li> <li class="md-nav__item"> <a href="#another-flavour-synblast" class="md-nav__link"> <span class="md-ellipsis"> Another flavour: syNBLAST </span> </a> </li> <li class="md-nav__item"> <a href="#a-real-world-example" class="md-nav__link"> <span class="md-ellipsis"> A real-world example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../tutorial_nblast_03_smat/" class="md-nav__link"> <span class="md-ellipsis"> Custom score matrices </span> </a> </li> <li class="md-nav__item"> <a href="../zzz_tutorial_nblast_01_flycircuit/" class="md-nav__link"> <span class="md-ellipsis"> NBLAST against FlyCircuit </span> </a> </li> <li class="md-nav__item"> <a href="../zzz_tutorial_nblast_02_hemibrain/" class="md-nav__link"> <span class="md-ellipsis"> NBLAST using light-level data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9"> <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0"> <span class="md-ellipsis"> Misc </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4_9"> <span class="md-nav__icon md-icon"></span> Misc </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../6_misc/tutorial_misc_00_multiprocess/" class="md-nav__link"> <span class="md-ellipsis"> Multiprocessing </span> </a> </li> <li class="md-nav__item"> <a href="../../6_misc/tutorial_misc_01_transforms/" class="md-nav__link"> <span class="md-ellipsis"> Transformations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../../../ecosystem/" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"></path></svg> <span class="md-ellipsis"> <span style="color:rgb(250,175,3)">NAVis</span> &amp; Friends </span> </a> </li> <li class="md-nav__item"> <a href="../../../../publications/" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"></path></svg> <span class="md-ellipsis"> Publications </span> </a> </li> <li class="md-nav__item"> <a href="../../../../changelog/" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.803.179Q8.76.171 7.72.38C5.639.797 3.974 1.828 2.77 3.445 1.232 5.515.367 8.072.049 11.492c-.125 1.353.008 2.711.181 4.216a9.97 9.97 0 0 0 2.144 5.214c.933 1.157 2.004 1.917 3.272 2.324a12 12 0 0 0 3.336.574 6 6 0 0 0 .795-.034l.416-.041a93 93 0 0 0 1.721-.186 21.4 21.4 0 0 0 7.393-2.257c2.007-1.048 3.41-2.594 4.17-4.597.354-.93.523-1.713.523-2.445a4.6 4.6 0 0 0-.064-.762c-.405-2.379-1.235-4.428-2.555-6.264-1.634-2.276-3.288-3.878-5.202-5.045C13.993.86 11.89.193 9.803.18Zm-.439 1.064q1.154-.032 2.376.237h-.001c2.73.597 5.137 2.002 7.154 4.173 2.288 2.46 3.591 5.045 3.988 7.899.071.528-.013 1.114-.096 1.622-.388 2.327-1.663 4.063-3.786 5.16a21 21 0 0 1-7.166 2.182c-.558.066-1.12.123-1.757.187l-.088.01a6.8 6.8 0 0 1-1.658-.03c-.69-.098-1.472-.21-2.224-.389-1.767-.42-3.069-1.622-3.978-3.658-.684-1.538-1.038-3.245-1.081-5.233a17.9 17.9 0 0 1 1.149-6.798c.62-1.641 1.517-3.453 3.462-4.418a8.75 8.75 0 0 1 3.706-.944m1.108 1.47a7.8 7.8 0 0 0-2.24.41c-1.6.525-2.718 1.304-3.523 2.438-1.499 2.118-2.275 4.58-2.31 7.325a10.1 10.1 0 0 0 .803 4.388c1.081 2.569 3.053 4.064 5.707 4.326 2.796.27 5.543-.381 8.178-1.937a8.1 8.1 0 0 0 2.772-2.624 7.1 7.1 0 0 0 1.168-3.86c0-2.162-1.015-4.47-3.049-6.862a6.4 6.4 0 0 0-.704-.707c-2.333-2.006-4.567-2.966-6.802-2.898zm.099 1.035c1.492-.022 3.015.475 4.672 1.508 1.783 1.117 3.161 2.763 4.091 4.909.887 2.02.905 3.938.058 5.696a6.8 6.8 0 0 1-2.907 2.988c-2.253 1.232-4.315 1.776-6.458 1.713h-.022c-1.55.06-2.89-.32-4.098-1.163-.7-.488-1.241-1.202-1.655-2.183a10.9 10.9 0 0 1-.872-4.273A12.7 12.7 0 0 1 4.404 8.09a12 12 0 0 1 .874-1.622l.163-.27c.67-1.108 1.725-1.639 3.103-2.099a6.8 6.8 0 0 1 2.027-.35zm.03 1.62c-1.18.037-2.28.465-3.289 1.283-1.395 1.13-2.23 2.72-2.63 4.993a7.24 7.24 0 0 0 .676 4.613c1.062 2.054 2.8 3.11 5.026 3.05h.008c2.958-.155 5.11-1.249 6.573-3.347a5.6 5.6 0 0 0 1.06-3.245 5.8 5.8 0 0 0-.242-1.639c-.72-2.435-2.161-4.145-4.29-5.085q-1.514-.667-2.892-.624Zm.312 1.064c.77.008 1.547.191 2.35.55 1.862.833 3.073 2.332 3.598 4.462.526 2.13-.27 4.205-2.066 5.423-1.479.999-2.93 1.447-4.438 1.367h-.04c-1.004.08-1.994-.226-2.943-.91a3.67 3.67 0 0 1-1.29-1.72 7.6 7.6 0 0 1-.514-2.727 8.5 8.5 0 0 1 .747-3.38c.676-1.556 1.724-2.503 3.215-2.893q.69-.18 1.38-.172zM9.455 8.758v6.882h1.155v-1.908l1.68 1.908h1.462l-2.273-2.5 1.871-1.958h-1.509l-1.231 1.337V8.758Z"></path></svg> <span class="md-ellipsis"> Changelog </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8"> <div class="md-nav__link md-nav__container"> <a href="../../../../api/" class="md-nav__link "> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10"></path></svg> <span class="md-ellipsis"> API Documentation </span> </a> <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> API Documentation </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1"> <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0"> <span class="md-ellipsis"> Code References </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1"> <span class="md-nav__icon md-icon"></span> Code References </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/" class="md-nav__link "> <span class="md-ellipsis"> navis </span> </a> <label class="md-nav__link " for="__nav_8_1_1" id="__nav_8_1_1_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_1_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1"> <span class="md-nav__icon md-icon"></span> navis </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/config/" class="md-nav__link"> <span class="md-ellipsis"> config </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_2"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/connectivity/" class="md-nav__link "> <span class="md-ellipsis"> connectivity </span> </a> <label class="md-nav__link " for="__nav_8_1_1_2" id="__nav_8_1_1_2_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_2"> <span class="md-nav__icon md-icon"></span> connectivity </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/connectivity/adjacency/" class="md-nav__link"> <span class="md-ellipsis"> adjacency </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/connectivity/similarity/" class="md-nav__link"> <span class="md-ellipsis"> similarity </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_3"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/conversion/" class="md-nav__link "> <span class="md-ellipsis"> conversion </span> </a> <label class="md-nav__link " for="__nav_8_1_1_3" id="__nav_8_1_1_3_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_3"> <span class="md-nav__icon md-icon"></span> conversion </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/conversion/meshing/" class="md-nav__link"> <span class="md-ellipsis"> meshing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_4"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/core/" class="md-nav__link "> <span class="md-ellipsis"> core </span> </a> <label class="md-nav__link " for="__nav_8_1_1_4" id="__nav_8_1_1_4_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_4"> <span class="md-nav__icon md-icon"></span> core </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/core/base/" class="md-nav__link"> <span class="md-ellipsis"> base </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/core/core_utils/" class="md-nav__link"> <span class="md-ellipsis"> core_utils </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/core/skeleton/" class="md-nav__link"> <span class="md-ellipsis"> skeleton </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_5"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/graph/" class="md-nav__link "> <span class="md-ellipsis"> graph </span> </a> <label class="md-nav__link " for="__nav_8_1_1_5" id="__nav_8_1_1_5_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_5"> <span class="md-nav__icon md-icon"></span> graph </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/graph/graph_utils/" class="md-nav__link"> <span class="md-ellipsis"> graph_utils </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/graph/clinic/" class="md-nav__link"> <span class="md-ellipsis"> clinic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_6"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/meshes/" class="md-nav__link "> <span class="md-ellipsis"> meshes </span> </a> <label class="md-nav__link " for="__nav_8_1_1_6" id="__nav_8_1_1_6_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_6"> <span class="md-nav__icon md-icon"></span> meshes </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/meshes/b3d/" class="md-nav__link"> <span class="md-ellipsis"> b3d </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/meshes/mesh_utils/" class="md-nav__link"> <span class="md-ellipsis"> mesh_utils </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/meshes/o3d/" class="md-nav__link"> <span class="md-ellipsis"> o3d </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/meshes/operations/" class="md-nav__link"> <span class="md-ellipsis"> operations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_7"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/models/" class="md-nav__link "> <span class="md-ellipsis"> models </span> </a> <label class="md-nav__link " for="__nav_8_1_1_7" id="__nav_8_1_1_7_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_7"> <span class="md-nav__icon md-icon"></span> models </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/models/network_models/" class="md-nav__link"> <span class="md-ellipsis"> network_models </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_8"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/morpho/" class="md-nav__link "> <span class="md-ellipsis"> morpho </span> </a> <label class="md-nav__link " for="__nav_8_1_1_8" id="__nav_8_1_1_8_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_8"> <span class="md-nav__icon md-icon"></span> morpho </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/morpho/ivscc/" class="md-nav__link"> <span class="md-ellipsis"> ivscc </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/morpho/mmetrics/" class="md-nav__link"> <span class="md-ellipsis"> mmetrics </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/morpho/persistence/" class="md-nav__link"> <span class="md-ellipsis"> persistence </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/morpho/subset/" class="md-nav__link"> <span class="md-ellipsis"> subset </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_9"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/nbl/" class="md-nav__link "> <span class="md-ellipsis"> nbl </span> </a> <label class="md-nav__link " for="__nav_8_1_1_9" id="__nav_8_1_1_9_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_9_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_9"> <span class="md-nav__icon md-icon"></span> nbl </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/nbl/ablast_funcs/" class="md-nav__link"> <span class="md-ellipsis"> ablast_funcs </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/nbl/nblast_funcs/" class="md-nav__link"> <span class="md-ellipsis"> nblast_funcs </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/nbl/smat/" class="md-nav__link"> <span class="md-ellipsis"> smat </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/nbl/synblast_funcs/" class="md-nav__link"> <span class="md-ellipsis"> synblast_funcs </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/nbl/utils/" class="md-nav__link"> <span class="md-ellipsis"> utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_10"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/plotting/" class="md-nav__link "> <span class="md-ellipsis"> plotting </span> </a> <label class="md-nav__link " for="__nav_8_1_1_10" id="__nav_8_1_1_10_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_10"> <span class="md-nav__icon md-icon"></span> plotting </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/colors/" class="md-nav__link"> <span class="md-ellipsis"> colors </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/dd/" class="md-nav__link"> <span class="md-ellipsis"> dd </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/ddd/" class="md-nav__link"> <span class="md-ellipsis"> ddd </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/plot_utils/" class="md-nav__link"> <span class="md-ellipsis"> plot_utils </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/settings/" class="md-nav__link"> <span class="md-ellipsis"> settings </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_10_6"> <label class="md-nav__link" for="__nav_8_1_1_10_6" id="__nav_8_1_1_10_6_label" tabindex="0"> <span class="md-ellipsis"> vispy </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_8_1_1_10_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_10_6"> <span class="md-nav__icon md-icon"></span> vispy </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/vispy/viewer/" class="md-nav__link"> <span class="md-ellipsis"> viewer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_10_7"> <label class="md-nav__link" for="__nav_8_1_1_10_7" id="__nav_8_1_1_10_7_label" tabindex="0"> <span class="md-ellipsis"> k3d </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_8_1_1_10_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_10_7"> <span class="md-nav__icon md-icon"></span> k3d </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/k3d/k3d_objects/" class="md-nav__link"> <span class="md-ellipsis"> k3d_objects </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_10_8"> <label class="md-nav__link" for="__nav_8_1_1_10_8" id="__nav_8_1_1_10_8_label" tabindex="0"> <span class="md-ellipsis"> plotly </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_8_1_1_10_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_10_8"> <span class="md-nav__icon md-icon"></span> plotly </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/plotting/plotly/graph_objs/" class="md-nav__link"> <span class="md-ellipsis"> graph_objs </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_11"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/transforms/" class="md-nav__link "> <span class="md-ellipsis"> transforms </span> </a> <label class="md-nav__link " for="__nav_8_1_1_11" id="__nav_8_1_1_11_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_11_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_11"> <span class="md-nav__icon md-icon"></span> transforms </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/align/" class="md-nav__link"> <span class="md-ellipsis"> align </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/affine/" class="md-nav__link"> <span class="md-ellipsis"> affine </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/base/" class="md-nav__link"> <span class="md-ellipsis"> base </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/cmtk/" class="md-nav__link"> <span class="md-ellipsis"> cmtk </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/elastix/" class="md-nav__link"> <span class="md-ellipsis"> elastix </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/factory/" class="md-nav__link"> <span class="md-ellipsis"> factory </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/h5reg/" class="md-nav__link"> <span class="md-ellipsis"> h5reg </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/templates/" class="md-nav__link"> <span class="md-ellipsis"> templates </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/transforms/thinplate/" class="md-nav__link"> <span class="md-ellipsis"> thinplate </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_12"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/utils/" class="md-nav__link "> <span class="md-ellipsis"> utils </span> </a> <label class="md-nav__link " for="__nav_8_1_1_12" id="__nav_8_1_1_12_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_12_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_12"> <span class="md-nav__icon md-icon"></span> utils </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/utils/cv/" class="md-nav__link"> <span class="md-ellipsis"> cv </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/utils/decorators/" class="md-nav__link"> <span class="md-ellipsis"> decorators </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_13"> <label class="md-nav__link" for="__nav_8_1_1_13" id="__nav_8_1_1_13_label" tabindex="0"> <span class="md-ellipsis"> intersection </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_13_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_13"> <span class="md-nav__icon md-icon"></span> intersection </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/intersection/intersect/" class="md-nav__link"> <span class="md-ellipsis"> intersect </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_14"> <label class="md-nav__link" for="__nav_8_1_1_14" id="__nav_8_1_1_14_label" tabindex="0"> <span class="md-ellipsis"> interfaces </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_14_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_14"> <span class="md-nav__icon md-icon"></span> interfaces </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/blender/" class="md-nav__link"> <span class="md-ellipsis"> blender </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/cave_utils/" class="md-nav__link"> <span class="md-ellipsis"> cave_utils </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/h01/" class="md-nav__link"> <span class="md-ellipsis"> h01 </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/insectbrain_db/" class="md-nav__link"> <span class="md-ellipsis"> insectbrain_db </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/microns/" class="md-nav__link"> <span class="md-ellipsis"> microns </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/neuprint/" class="md-nav__link"> <span class="md-ellipsis"> neuprint </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/neuromorpho/" class="md-nav__link"> <span class="md-ellipsis"> neuromorpho </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_14_8"> <div class="md-nav__link md-nav__container"> <a href="../../../../reference/navis/interfaces/neuron/" class="md-nav__link "> <span class="md-ellipsis"> neuron </span> </a> <label class="md-nav__link " for="__nav_8_1_1_14_8" id="__nav_8_1_1_14_8_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_8_1_1_14_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_14_8"> <span class="md-nav__icon md-icon"></span> neuron </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/neuron/comp/" class="md-nav__link"> <span class="md-ellipsis"> comp </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/interfaces/neuron/network/" class="md-nav__link"> <span class="md-ellipsis"> network </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_15"> <label class="md-nav__link" for="__nav_8_1_1_15" id="__nav_8_1_1_15_label" tabindex="0"> <span class="md-ellipsis"> io </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_15_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_15"> <span class="md-nav__icon md-icon"></span> io </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/io/base/" class="md-nav__link"> <span class="md-ellipsis"> base </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/hdf_io/" class="md-nav__link"> <span class="md-ellipsis"> hdf_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/mesh_io/" class="md-nav__link"> <span class="md-ellipsis"> mesh_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/nmx_io/" class="md-nav__link"> <span class="md-ellipsis"> nmx_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/nrrd_io/" class="md-nav__link"> <span class="md-ellipsis"> nrrd_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/precomputed_io/" class="md-nav__link"> <span class="md-ellipsis"> precomputed_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/rda_io/" class="md-nav__link"> <span class="md-ellipsis"> rda_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/swc_io/" class="md-nav__link"> <span class="md-ellipsis"> swc_io </span> </a> </li> <li class="md-nav__item"> <a href="../../../../reference/navis/io/tiff_io/" class="md-nav__link"> <span class="md-ellipsis"> tiff_io </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1_1_16"> <label class="md-nav__link" for="__nav_8_1_1_16" id="__nav_8_1_1_16_label" tabindex="0"> <span class="md-ellipsis"> sampling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_1_1_16_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8_1_1_16"> <span class="md-nav__icon md-icon"></span> sampling </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../reference/navis/sampling/downsampling/" class="md-nav__link"> <span class="md-ellipsis"> downsampling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#what-is-nblast" class="md-nav__link"> <span class="md-ellipsis"> What is NBLAST? </span> </a> </li> <li class="md-nav__item"> <a href="#running-nblast" class="md-nav__link"> <span class="md-ellipsis"> Running NBLAST </span> </a> </li> <li class="md-nav__item"> <a href="#another-flavour-synblast" class="md-nav__link"> <span class="md-ellipsis"> Another flavour: syNBLAST </span> </a> </li> <li class="md-nav__item"> <a href="#a-real-world-example" class="md-nav__link"> <span class="md-ellipsis"> A real-world example </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Click <a href="#download_links">here</a> to download the full example code</p> </div> <h1 id="nblast">NBLAST<a class="headerlink" href="#nblast" title="Permanent link">#</a></h1> <p>This tutorial will introduce you to NBLAST (Costa et al., 2016), a method to compare neurons based on their morphology.</p> <h2 id="what-is-nblast">What is NBLAST?<a class="headerlink" href="#what-is-nblast" title="Permanent link">#</a></h2> <p>A brief introduction (modified from Jefferis lab's <a href="http://flybrain.mrc-lmb.cam.ac.uk/si/nblast/www/">website</a>):</p> <p>NBLAST works by decomposing neurons into point and tangent vector representations - so called "dotprops". Similarity between a given query and a given target neuron is determined by:</p> <ol> <li> <p>Nearest-neighbor search:</p> <p>For each point + tangent vector <span class="arithmatex">\(u_{i}\)</span> of the query neuron, find the closest point + tangent vector <span class="arithmatex">\(v_{i}\)</span> on the target neuron (this is a simple nearest-neighbor search using Euclidean distance).</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="NBLAST_neuron_comparison" src="../../../../_static/NBLAST_neuron_comparison.png"></a></p> </li> <li> <p>Calculate a raw score:</p> <p>The raw score is a <code>weighted</code> product from the distance <span class="arithmatex">\(d_{i}\)</span> between the points in each pair and the absolute dot product of the two tangent vectors <span class="arithmatex">\(| \vec{u_i} \cdot \vec{v_i} |\)</span>.</p> <p>The absolute dot product is used because the orientation of the tangent vectors typically has no meaning in our data representation.</p> <p>A suitable scoring function <span class="arithmatex">\(f\)</span> was determined empirically (see the <a href="http://flybrain.mrc-lmb.cam.ac.uk/si/nblast/www/paper/">NBLAST paper</a>) and is shipped with <span style="color:rgb(250,175,3)">NAVis</span> as scoring matrices:</p> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="NBLAST_score_mat" src="../../../../_static/NBLAST_score_mat_inv.png"></a></p> <p>Importantly, these matrices were created using <em>Drosophila</em> neurons from the <a href="http://flycircuit.tw/">FlyCircuit</a> light-level dataset which are in microns. Consequently, you should make sure your neurons are also in micrometer units for NBLAST! If you are working on non-insect neurons you might have to play around with the scaling to improve results. Alternatively, you can also produce your own scoring function (see <a href="../tutorial_nblast_03_smat">this tutorial</a>).</p> </li> <li> <p>Produce a per-pair score:</p> <p>This is done by simply summing up the raw scores over all point + tangent vector pairs for a given query-target neuron pair.</p> </li> <li> <p>Normalize raw score</p> <p>This step is optional but highly recommended: normalizing the raw score by dividing by the raw score of a self-self comparison of the query neuron.</p> </li> </ol> <p>Putting it all together, the formula for the raw score <span class="arithmatex">\(S\)</span> is:</p> <div class="arithmatex">\[ S(query,target)=\sum_{i=1}^{n}f(d_{i}, |\vec{u_i} \cdot \vec{v_i}|) \]</div> <div class="admonition important"> <p class="admonition-title">The direction of the comparison matters!</p> <p>Consider two very different neurons - one large, one small - that overlap in space. If the small neuron is the query, you will always find a close-by nearest-neighbour among the many points of the large target neuron. Consequently, this small <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"></path></svg></span> large comparison will produce a decent NBLAST score. By contrast, the other way around (large <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"></path></svg></span> small) will likely produce a bad NBLAST score because many points in the large neuron are far away from the closest point in the small neuron. In practice, we typically use the mean between those forward and the reverse scores. This is done either by running two NBLASTs (query <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"></path></svg></span> target and target <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"></path></svg></span> query), or by passing e.g. <code>scores="mean"</code> to the respective NBLAST function.</p> </div> <h2 id="running-nblast">Running NBLAST<a class="headerlink" href="#running-nblast" title="Permanent link">#</a></h2> <p>Broadly speaking, there are two applications for NBLAST:</p> <ol> <li>Matching neurons neurons between two datasets</li> <li>Clustering neurons into morphologically similar groups</li> </ol> <p>Before we get our feet wet, two things to keep in mind:</p> <ul> <li>neurons should be in microns as this is what NBLAST's scoring matrices have been optimized for (see above)</li> <li>neurons should have similar sampling resolution (i.e. points per unit of cable)</li> </ul> <details class="example"> <summary>Speeding up NBLAST</summary> <p>For a ~2x speed boost, install the <a href="https://github.com/storpipfugl/pykdtree">pykdtree</a> library: <code>pip3 install pykdtree</code>.</p> <p>If you installed <span style="color:rgb(250,175,3)">NAVis</span> with the <code>pip install navis[all]</code> option you should already have it.</p> </details> <p>OK, let's get started!</p> <p>We will use the example neurons that come with <span style="color:rgb(250,175,3)">NAVis</span>. These are all of the same type, so we don't expect to find very useful clusters - good enough to demo though!</p> <p>Load example neurons</p> <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">navis</span>

<span class="n">nl</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">example_neurons</span><span class="p">()</span>
</code></pre></div> <p>NBLAST works on dotprops - these consist of points and tangent vectors decribing the shape of a neuron and are represented by the <a class="autorefs autorefs-internal" href="../../../../reference/navis/#navis.Dotprops"><code>navis.Dotprops</code></a> class in <span style="color:rgb(250,175,3)">NAVis</span>. You can generate those dotprops from skeletons (i.e. <a class="autorefs autorefs-internal" title="navis.TreeNeuron" href="../../../../reference/navis/#navis.TreeNeuron"><code>TreeNeurons</code></a>), meshes (i.e. <a class="autorefs autorefs-internal" title="navis.MeshNeuron" href="../../../../reference/navis/#navis.MeshNeuron"><code>MeshNeurons</code></a>) (see <a class="autorefs autorefs-internal" title="navis.make_dotprops" href="../../../../reference/navis/#navis.make_dotprops"><code>navis.make_dotprops</code></a> for details) or straight from image data (see <a class="autorefs autorefs-internal" title="navis.read_nrrd" href="../../../../reference/navis/#navis.read_nrrd"><code>navis.read_nrrd</code></a> and <a class="autorefs autorefs-internal" title="navis.read_tiff" href="../../../../reference/navis/#navis.read_tiff"><code>navis.read_tiff</code></a>) - e.g. confocal stacks.</p> <div class="highlight"><pre><span></span><code><span class="c1"># Convert neurons into microns (they are 8nm)</span>
<span class="n">nl_um</span> <span class="o">=</span> <span class="n">nl</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>

<span class="c1"># Generate dotprops</span>
<span class="n">dps</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">make_dotprops</span><span class="p">(</span><span class="n">nl_um</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Run the actual NBLAST: the first two vs the last two neurons</span>
<span class="n">nbl</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">nblast</span><span class="p">(</span><span class="n">dps</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dps</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">nbl</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> <div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th>target</th> <th>722817260</th> <th>754534424</th> <th>754538881</th> </tr> <tr> <th>query</th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>1734350788</th> <td>0.751944</td> <td>0.734036</td> <td>0.770660</td> </tr> <tr> <th>1734350908</th> <td>0.679263</td> <td>0.763096</td> <td>0.753379</td> </tr> </tbody> </table> </div> </div> <p>Painless, wasn't it? The <code>nbl</code> scores dataframe has the query neurons as rows and the target neurons as columns.</p> <p>Let's run an all-by-all NBLAST next:</p> <div class="highlight"><pre><span></span><code><span class="n">aba</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">nblast_allbyall</span><span class="p">(</span><span class="n">dps</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">aba</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> <div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th>target</th> <th>1734350788</th> <th>1734350908</th> <th>722817260</th> <th>754534424</th> <th>754538881</th> </tr> <tr> <th>query</th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>1734350788</th> <td>1.000000</td> <td>0.744841</td> <td>0.751944</td> <td>0.734036</td> <td>0.770660</td> </tr> <tr> <th>1734350908</th> <td>0.732854</td> <td>1.000000</td> <td>0.679263</td> <td>0.763096</td> <td>0.753379</td> </tr> <tr> <th>722817260</th> <td>0.773451</td> <td>0.741444</td> <td>1.000000</td> <td>0.742954</td> <td>0.793883</td> </tr> <tr> <th>754534424</th> <td>0.766740</td> <td>0.766891</td> <td>0.714837</td> <td>1.000000</td> <td>0.785283</td> </tr> <tr> <th>754538881</th> <td>0.761127</td> <td>0.751072</td> <td>0.753679</td> <td>0.762648</td> <td>1.000000</td> </tr> </tbody> </table> </div> </div> <p>This demonstrates two things:</p> <ol> <li>The forward and reverse scores are never exactly the same (as noted above).</li> <li>The diagonal is always 1 because it is a self-self comparison (i.e. a perfect match) and we normalize against that.</li> </ol> <p>Let's run some quick &amp; dirty analysis just to illustrate things.</p> <p>For hierarchical clustering we need the matrix to be symmetrical - which our all-by-all matrix is not. We will therefore use the mean of forward and reverse scores (you could also use e.g. the minimum or the maximum):</p> <div class="highlight"><pre><span></span><code><span class="n">aba_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">aba</span> <span class="o">+</span> <span class="n">aba</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div> <p>We also need distances instead of similarities!</p> <p>Invert to get distances Because our scores are normalized, we know the max similarity is 1</p> <div class="highlight"><pre><span></span><code><span class="n">aba_dist</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">aba_mean</span>
<span class="n">aba_dist</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> <div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th>target</th> <th>1734350788</th> <th>1734350908</th> <th>722817260</th> <th>754534424</th> <th>754538881</th> </tr> <tr> <th>query</th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>1734350788</th> <td>0.000000</td> <td>0.261152</td> <td>0.237303</td> <td>0.249612</td> <td>0.234106</td> </tr> <tr> <th>1734350908</th> <td>0.261152</td> <td>0.000000</td> <td>0.289647</td> <td>0.235006</td> <td>0.247775</td> </tr> <tr> <th>722817260</th> <td>0.237303</td> <td>0.289647</td> <td>0.000000</td> <td>0.271104</td> <td>0.226219</td> </tr> <tr> <th>754534424</th> <td>0.249612</td> <td>0.235006</td> <td>0.271104</td> <td>0.000000</td> <td>0.226034</td> </tr> <tr> <th>754538881</th> <td>0.234106</td> <td>0.247775</td> <td>0.226219</td> <td>0.226034</td> <td>0.000000</td> </tr> </tbody> </table> </div> </div> <p>Now we can use scipy's hierarchical clustering to generate a dendrogram</p> <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">squareform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.cluster.hierarchy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">set_link_color_palette</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">set_link_color_palette</span><span class="p">([</span><span class="n">mcl</span><span class="o">.</span><span class="n">to_hex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"muted"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>

<span class="c1"># To generate a linkage, we have to bring the matrix from square-form to vector-form</span>
<span class="n">aba_vec</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">aba_dist</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Generate linkage</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">aba_vec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"ward"</span><span class="p">)</span>

<span class="c1"># Plot a dendrogram</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">aba_mean</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">"right"</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="tutorial nblast 00 intro" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_nblast_00_intro_001.png" srcset="../images/mkd_glr_tutorial_nblast_00_intro_001.png, ../images/mkd_glr_tutorial_nblast_00_intro_001_2_0x.png 2.0x"></a></p> <p>We'll leave it at that for now but just to have it mentioned: there is also a <a class="autorefs autorefs-internal" title="navis.nblast_smart" href="../../../../reference/navis/#navis.nblast_smart"><code>navis.nblast_smart</code></a> function which tries to cut some corners and may be useful if you want to run very large NBLASTs.</p> <p>These are the functions we seen so far:</p> <ul> <li><a class="autorefs autorefs-internal" title="navis.nblast" href="../../../../reference/navis/#navis.nblast"><code>navis.nblast</code></a>: classic query <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0"></path></svg></span> target NBLAST</li> <li><a class="autorefs autorefs-internal" title="navis.nblast_allbyall" href="../../../../reference/navis/#navis.nblast_allbyall"><code>navis.nblast_allbyall</code></a>: pairwise, all-by-all NBLAST</li> <li><a class="autorefs autorefs-internal" title="navis.nblast_smart" href="../../../../reference/navis/#navis.nblast_smart"><code>navis.nblast_smart</code></a>: a "smart" version of NBLAST</li> </ul> <h2 id="another-flavour-synblast">Another flavour: syNBLAST<a class="headerlink" href="#another-flavour-synblast" title="Permanent link">#</a></h2> <p>SyNBLAST is synapse-based NBLAST: instead of turning neurons into dotprops, we use their synapses to perform NBLAST (minus the vector component). This is generally faster because we can skip generating dotprops and calculating vector dotproducts. It also focusses the attention on the synapse-bearing axons and dendrites, effectively ignoring the backbone. This changes the question from "<em>Do neurons look the same?</em>" to "<em>Do neurons have in- and output in the same area?</em>". See <a class="autorefs autorefs-internal" title="navis.synblast" href="../../../../reference/navis/#navis.synblast"><code>navis.synblast</code></a> for details.</p> <p>Let's try the above but with syNBLAST:</p> <div class="highlight"><pre><span></span><code><span class="c1"># Importantly, we still want to use data in microns!</span>
<span class="n">synbl</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">synblast</span><span class="p">(</span><span class="n">nl_um</span><span class="p">,</span> <span class="n">nl_um</span><span class="p">,</span> <span class="n">by_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">synbl</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> <div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th>target</th> <th>1734350788</th> <th>1734350908</th> <th>722817260</th> <th>754534424</th> <th>754538881</th> </tr> <tr> <th>query</th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>1734350788</th> <td>1.000000</td> <td>0.831690</td> <td>0.828234</td> <td>0.820261</td> <td>0.849559</td> </tr> <tr> <th>1734350908</th> <td>0.831721</td> <td>1.000000</td> <td>0.741676</td> <td>0.857372</td> <td>0.833785</td> </tr> <tr> <th>722817260</th> <td>0.842672</td> <td>0.827759</td> <td>1.000000</td> <td>0.815891</td> <td>0.853005</td> </tr> <tr> <th>754534424</th> <td>0.862494</td> <td>0.853088</td> <td>0.793840</td> <td>1.000000</td> <td>0.866798</td> </tr> <tr> <th>754538881</th> <td>0.845366</td> <td>0.833463</td> <td>0.829094</td> <td>0.844647</td> <td>1.000000</td> </tr> </tbody> </table> </div> </div> <p>The same as above, we can run an all-by-all synNBLAST and generate a dendrogram:</p> <div class="highlight"><pre><span></span><code><span class="n">aba_vec</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(((</span><span class="n">synbl</span> <span class="o">+</span> <span class="n">synbl</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">aba_vec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"ward"</span><span class="p">)</span>

<span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">synbl</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">"right"</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="tutorial nblast 00 intro" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_nblast_00_intro_002.png" srcset="../images/mkd_glr_tutorial_nblast_00_intro_002.png, ../images/mkd_glr_tutorial_nblast_00_intro_002_2_0x.png 2.0x"></a></p> <h2 id="a-real-world-example">A real-world example<a class="headerlink" href="#a-real-world-example" title="Permanent link">#</a></h2> <p>The toy data above is not really suited to demonstrate NBLAST because these neurons are of the same type (i.e. we do not expect to see differences).</p> <p>Let's try something more elaborate and pull some hemibrain neurons from <a href="https://neuprint.janelia.org/">neuPrint</a>. For this you need to install the <code>neuprint-python</code> package (<code>pip3 install neuprint-python</code>), make a neuPrint account and generate/set an authentication token. Sounds complicated but is all pretty painless - see the <a href="https://connectome-neuprint.github.io/neuprint-python/docs/quickstart.html">neuPrint documentation</a> for details. There is also a separate <span style="color:rgb(250,175,3)">NAVis</span> tutorial on neuprint <a href="../4_remote/tutorial_remote_00_neuprint">here</a>.</p> <p>Once that's done we can get started by importing the neuPrint interface from <span style="color:rgb(250,175,3)">NAVis</span>:</p> <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">navis.interfaces.neuprint</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">neu</span>

<span class="c1"># Set a client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">neu</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s2">"https://neuprint.janelia.org"</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">"hemibrain:v1.2.1"</span><span class="p">)</span>
</code></pre></div> <p>Next we will fetch all olfactory projection neurons of the lateral lineage using a regex pattern.</p> <div class="highlight"><pre><span></span><code><span class="n">pns</span> <span class="o">=</span> <span class="n">neu</span><span class="o">.</span><span class="n">fetch_skeletons</span><span class="p">(</span>
    <span class="n">neu</span><span class="o">.</span><span class="n">NeuronCriteria</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">".*lPN.*"</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">with_synapses</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="n">client</span>
<span class="p">)</span>

<span class="c1"># Drop neurons on the left hand side</span>
<span class="n">pns</span> <span class="o">=</span> <span class="n">pns</span><span class="p">[[</span><span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"_L"</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pns</span><span class="p">]]</span>

<span class="n">pns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div> <p class="mkd-glr-script-out">Out:</p> <div class="mkd-glr-script-out-disp highlight"><pre><span></span><code><span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.44it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.43it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.48it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.48it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.38it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.38it/s]</span>





<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.65it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.64it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.86it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.86it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.28it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.28it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.36it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.36it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.52it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.52it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  1.30it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  1.30it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.28it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.28it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.51it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.50it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.52it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.51it/s]</span>





<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.78it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.77it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.46it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.45it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.50it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.50it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.21it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.20it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.57it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.57it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.91it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.91it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.57it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.57it/s]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.04it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.03it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.10it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.09it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.71it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.71it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.28it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.28it/s]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.79it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.78it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.91it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.91it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.91it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.90it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.79it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.78it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.29it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.29it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.49it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.48it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.38it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.38it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.15it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.14it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.36it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.36it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.30it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.29it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.75it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.74it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.46it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.46it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>





<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.81it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.81it/s]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.99it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.99it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.26it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.26it/s]</span>





<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.31it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.31it/s]</span>






<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.63it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.63it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.43it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.42it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.91it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.91it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.92it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.92it/s]</span>





<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.50it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.50it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.30it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.30it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.91it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.90it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.26it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.25it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.92it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.92it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.08it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.08it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.47it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.46it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.22it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  6.21it/s]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.57it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.57it/s]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.62it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.62it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>




<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.94it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  3.93it/s]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>

<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.82it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  4.81it/s]</span>


<span class="w">  </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;?,<span class="w"> </span>?it/s<span class="o">]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.34it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  5.33it/s]</span>



<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.71it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.71it/s]</span>


<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.96it/s]</span>
<span class="m">100</span>%<span class="p">|</span><span class="c1">##########| 1/1 [00:00&lt;00:00,  2.96it/s]</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> <div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>type</th> <th>name</th> <th>id</th> <th>n_nodes</th> <th>n_connectors</th> <th>n_branches</th> <th>n_leafs</th> <th>cable_length</th> <th>soma</th> <th>units</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>navis.TreeNeuron</td> <td>VA5_lPN_R</td> <td>574032862</td> <td>4509</td> <td>2849</td> <td>739</td> <td>763</td> <td>302345.37500</td> <td>9.0</td> <td>8 nanometer</td> </tr> <tr> <th>1</th> <td>navis.TreeNeuron</td> <td>VA5_lPN_R</td> <td>574037281</td> <td>4365</td> <td>2891</td> <td>719</td> <td>756</td> <td>299413.90625</td> <td>19.0</td> <td>8 nanometer</td> </tr> <tr> <th>2</th> <td>navis.TreeNeuron</td> <td>VA5_lPN_R</td> <td>574374051</td> <td>4480</td> <td>3000</td> <td>751</td> <td>786</td> <td>309890.12500</td> <td>6.0</td> <td>8 nanometer</td> </tr> <tr> <th>3</th> <td>navis.TreeNeuron</td> <td>VP1l+VP3_ilPN</td> <td>603785283</td> <td>8920</td> <td>2345</td> <td>887</td> <td>915</td> <td>396369.37500</td> <td>NaN</td> <td>8 nanometer</td> </tr> <tr> <th>4</th> <td>navis.TreeNeuron</td> <td>VC1_lPN_R</td> <td>606090268</td> <td>7247</td> <td>6862</td> <td>1556</td> <td>1603</td> <td>559409.12500</td> <td>7096.0</td> <td>8 nanometer</td> </tr> </tbody> </table> </div> </div> <p>Generate dotprops</p> <div class="highlight"><pre><span></span><code><span class="c1"># These neurons are in 8x8x8nm (voxel) resolution</span>
<span class="n">pns_um</span> <span class="o">=</span> <span class="n">pns</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># convert to microns</span>
<span class="n">pns_dps</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">make_dotprops</span><span class="p">(</span><span class="n">pns_um</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pns_dps</span>
</code></pre></div> <div class="output_subarea output_html rendered_html output_result"> &lt;class 'navis.core.neuronlist.NeuronList'&gt; containing 54 neurons (7.6MiB)<div> <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>type</th> <th>name</th> <th>id</th> <th>k</th> <th>units</th> <th>n_points</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>navis.Dotprops</td> <td>VA5_lPN_R</td> <td>574032862</td> <td>5</td> <td>1.0 micrometer</td> <td>4509</td> </tr> <tr> <th>1</th> <td>navis.Dotprops</td> <td>VA5_lPN_R</td> <td>574037281</td> <td>5</td> <td>1.0 micrometer</td> <td>4365</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>52</th> <td>navis.Dotprops</td> <td>VA7m_lPN_R</td> <td>5813055180</td> <td>5</td> <td>1.0 micrometer</td> <td>3739</td> </tr> <tr> <th>53</th> <td>navis.Dotprops</td> <td>DM2_lPN_R</td> <td>5901222910</td> <td>5</td> <td>1.0 micrometer</td> <td>6484</td> </tr> </tbody> </table> </div> </div> <p>Run an all-by-all NBLAST and synNBLAST</p> <div class="highlight"><pre><span></span><code><span class="n">pns_nbl</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">nblast_allbyall</span><span class="p">(</span><span class="n">pns_dps</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pns_synbl</span> <span class="o">=</span> <span class="n">navis</span><span class="o">.</span><span class="n">synblast</span><span class="p">(</span><span class="n">pns_um</span><span class="p">,</span> <span class="n">pns_um</span><span class="p">,</span> <span class="n">by_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Generate the linear vectors</span>
<span class="n">nbl_vec</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(((</span><span class="n">pns_nbl</span> <span class="o">+</span> <span class="n">pns_nbl</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">synbl_vec</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(((</span><span class="n">pns_synbl</span> <span class="o">+</span> <span class="n">pns_synbl</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Generate linkages</span>
<span class="n">Z_nbl</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">nbl_vec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"ward"</span><span class="p">,</span> <span class="n">optimal_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Z_synbl</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">synbl_vec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"ward"</span><span class="p">,</span> <span class="n">optimal_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot dendrograms</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">dn1</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z_nbl</span><span class="p">,</span> <span class="n">no_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dn2</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z_synbl</span><span class="p">,</span> <span class="n">no_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"NBLAST"</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"synNBLAST"</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="NBLAST, synNBLAST" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_nblast_00_intro_003.png" srcset="../images/mkd_glr_tutorial_nblast_00_intro_003.png, ../images/mkd_glr_tutorial_nblast_00_intro_003_2_0x.png 2.0x"></a></p> <p>While we don't know which leaf is which, the structure in both dendrograms looks similar. If we wanted to take it further than that, we could use <a href="https://github.com/schlegelp/tanglegram">tanglegram</a> to line up the two clusterings and compare them.</p> <p>But let's save that for another day and instead do some plotting:</p> <p>Generate clusters</p> <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.cluster.hierarchy</span><span class="w"> </span><span class="kn">import</span> <span class="n">fcluster</span>

<span class="n">cl</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z_synbl</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">"distance"</span><span class="p">)</span>
<span class="n">cl</span>
</code></pre></div> <p class="mkd-glr-script-out">Out:</p> <div class="mkd-glr-script-out-disp highlight"><pre><span></span><code>array<span class="o">([</span><span class="w"> </span><span class="m">6</span>,<span class="w">  </span><span class="m">6</span>,<span class="w">  </span><span class="m">6</span>,<span class="w"> </span><span class="m">14</span>,<span class="w">  </span><span class="m">3</span>,<span class="w">  </span><span class="m">8</span>,<span class="w">  </span><span class="m">8</span>,<span class="w">  </span><span class="m">8</span>,<span class="w">  </span><span class="m">8</span>,<span class="w"> </span><span class="m">15</span>,<span class="w">  </span><span class="m">2</span>,<span class="w">  </span><span class="m">2</span>,<span class="w">  </span><span class="m">7</span>,<span class="w">  </span><span class="m">2</span>,<span class="w"> </span><span class="m">13</span>,<span class="w"> </span><span class="m">10</span>,<span class="w"> </span><span class="m">10</span>,
<span class="w">       </span><span class="m">14</span>,<span class="w">  </span><span class="m">1</span>,<span class="w">  </span><span class="m">1</span>,<span class="w"> </span><span class="m">13</span>,<span class="w">  </span><span class="m">3</span>,<span class="w">  </span><span class="m">1</span>,<span class="w"> </span><span class="m">10</span>,<span class="w"> </span><span class="m">11</span>,<span class="w"> </span><span class="m">10</span>,<span class="w">  </span><span class="m">2</span>,<span class="w">  </span><span class="m">2</span>,<span class="w">  </span><span class="m">7</span>,<span class="w">  </span><span class="m">2</span>,<span class="w">  </span><span class="m">7</span>,<span class="w">  </span><span class="m">7</span>,<span class="w">  </span><span class="m">9</span>,<span class="w">  </span><span class="m">7</span>,
<span class="w">        </span><span class="m">9</span>,<span class="w">  </span><span class="m">4</span>,<span class="w"> </span><span class="m">11</span>,<span class="w">  </span><span class="m">3</span>,<span class="w">  </span><span class="m">9</span>,<span class="w">  </span><span class="m">5</span>,<span class="w">  </span><span class="m">9</span>,<span class="w"> </span><span class="m">12</span>,<span class="w">  </span><span class="m">9</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">15</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">11</span>,<span class="w"> </span><span class="m">11</span>,<span class="w"> </span><span class="m">12</span>,<span class="w">  </span><span class="m">2</span>,<span class="w"> </span><span class="m">13</span>,
<span class="w">        </span><span class="m">5</span>,<span class="w">  </span><span class="m">5</span>,<span class="w">  </span><span class="m">8</span><span class="o">]</span>,<span class="w"> </span><span class="nv">dtype</span><span class="o">=</span>int32<span class="o">)</span>
</code></pre></div> <p>Now plot each cluster. For simplicity we are plotting in 2D here:</p> <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">cols</span><span class="p">))</span>
<span class="c1"># Flatten axes</span>
<span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">axes</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>

<span class="c1"># Generate colors</span>
<span class="n">pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"muted"</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"cluster </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># Get the neurons in this cluster</span>
    <span class="n">this</span> <span class="o">=</span> <span class="n">pns</span><span class="p">[</span><span class="n">cl</span> <span class="o">==</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="n">navis</span><span class="o">.</span><span class="n">plot2d</span><span class="p">(</span>
        <span class="n">this</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"2d"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span> <span class="s2">"-z"</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

    <span class="c1"># Set all axes to the same limits</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">pns</span><span class="o">.</span><span class="n">bbox</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="cluster 1, cluster 2, cluster 3, cluster 4, cluster 5, cluster 6, cluster 7, cluster 8, cluster 9, cluster 10, cluster 11, cluster 12, cluster 13, cluster 14, cluster 15" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_nblast_00_intro_004.png" srcset="../images/mkd_glr_tutorial_nblast_00_intro_004.png, ../images/mkd_glr_tutorial_nblast_00_intro_004_2_0x.png 2.0x"></a></p> <p>Note how clusters 3 and 8 look a bit odd? That's because these likely still contain more than one type of neuron. We should probably have gone with a slightly finer clustering. But this little demo should be enough to get you started!</p> <p><strong>Total running time of the script:</strong> ( 0 minutes 44.085 seconds)</p> <div id="download_links"></div> <p><a class="md-button center" href="../tutorial_nblast_00_intro.py"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v210.7l-41.4-41.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 242.7zM64 320c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64h-46.9l-56.6 56.6c-31.2 31.2-81.9 31.2-113.1 0L110.9 320zm304 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"></path></svg></span> Download Python source code: tutorial_nblast_00_intro.py</a></p> <p><a class="md-button center" href="../tutorial_nblast_00_intro.ipynb"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v210.7l-41.4-41.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 242.7zM64 320c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64h-46.9l-56.6 56.6c-31.2 31.2-81.9 31.2-113.1 0L110.9 320zm304 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"></path></svg></span> Download Jupyter notebook: tutorial_nblast_00_intro.ipynb</a></p> <p><a class="mkd-glr-signature" href="https://smarie.github.io/mkdocs-gallery">Gallery generated by mkdocs-gallery</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["content.tabs.link", "content.code.annotate", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../../../../assets/_markdown_exec_pyodide.js"></script> <script src="../../../../javascripts/katex.js"></script> <script src="../../../../assets/external/unpkg.com/katex@0/dist/katex.min.js"></script> <script src="../../../../assets/external/unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script> <script src="../../../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>  <script id="init-glightbox">document.querySelectorAll('.glightbox').forEach(function(element) {
    try {
        var img = element.querySelector('img');
        if (img && img.src) {
            element.setAttribute('href', img.src);
        } else {
            console.log('No img element with src attribute found');
        }
    } catch (error) {
        console.log('Error:', error);
    }
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>